SELECT
CASE
    WHEN AGE BETWEEN 18 AND 25 THEN '18-25'
    WHEN AGE BETWEEN 26 AND 35 THEN '26-35'
    WHEN AGE BETWEEN 36 AND 50 THEN '36-50'
    WHEN AGE BETWEEN 51 AND 65 THEN '51-65'
    ELSE '65+'
END AS AGE_GROUP,
ROUND(AVG(CL.CLAIM_AMOUNT)) AS AVERAGE_CLAIM_AMOUNT
FROM CUSTOMER_INSURANCE C
JOIN POLICIES_INSURANCE P ON P.CUSTOMER_ID = C.CUSTOMER_ID
JOIN CLAIM_INSURANCE CL ON CL.POLICY_ID = P.POLICY_ID
GROUP BY
CASE
    WHEN AGE BETWEEN 18 AND 25 THEN '18-25'
    WHEN AGE BETWEEN 26 AND 35 THEN '26-35'
    WHEN AGE BETWEEN 36 AND 50 THEN '36-50'
    WHEN AGE BETWEEN 51 AND 65 THEN '51-65'
    ELSE '65+'
END
ORDER BY AGE_GROUP;
